<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oxy's Gallery</title>
    <link rel="icon" type="image/png" href="https://img.icons8.com/office/40/dog.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        setInterval(async function () {
            try {
                const res = await fetch("/refresh");
                const data = await res.json();
                if (data.should_refresh) {
                    window.location.reload();
                }
            } catch (e) {
                console.error("Polling error:", e);
            }
        }, 1000); // every 1 second
    </script>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                        'ubuntu': ['Ubuntu', 'sans-serif'],
                    },
                    colors: {
                        white: '#FFFFFF',
                        black: '#000000',
                        accent: '#44F2E9',
                        highlight: '#FF7300',
                        'primary-grad': '#171152',
                        secondary: '#070518',
                        'tertiary-grad': '#251A7E',
                    },
                    animation: {
                        'spin-slow': 'spin 1s linear infinite',
                        'slide-in-right': 'slideInRight 0.3s ease-out',
                        'slide-out-right': 'slideOutRight 0.3s ease-in',
                        'modal-in': 'modalSlideIn 0.3s ease-out',
                        'modal-out': 'modalSlideOut 0.3s ease-in',
                    },
                    keyframes: {
                        slideInRight: {
                            from: { transform: 'translateX(100%)', opacity: '0' },
                            to: { transform: 'translateX(0)', opacity: '1' }
                        },
                        slideOutRight: {
                            from: { transform: 'translateX(0)', opacity: '1' },
                            to: { transform: 'translateX(100%)', opacity: '0' }
                        },
                        modalSlideIn: {
                            from: { opacity: '0', transform: 'scale(0.9) translateY(20px)' },
                            to: { opacity: '1', transform: 'scale(1) translateY(0)' }
                        },
                        modalSlideOut: {
                            from: { opacity: '1', transform: 'scale(1) translateY(0)' },
                            to: { opacity: '0', transform: 'scale(0.9) translateY(20px)' }
                        }
                    },
                    backdropBlur: {
                        xs: '2px',
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom CSS for features not available in Tailwind utility classes */
        .gradient-primary {
            background: linear-gradient(135deg, #171152, #251A7E);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #171152, #251A7E);
        }
        
        .image-overlay-gradient {
            background: linear-gradient(transparent, rgba(0,0,0,0.6));
        }
        
        .thumbnail-overlay-gradient {
            background: linear-gradient(transparent, rgba(0,0,0,0.6));
        }
        
        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.5);
        }
        
        /* Firefox scrollbar */
        .custom-scrollbar {
            scrollbar-width: thin;
            scrollbar-color: rgba(255,255,255,0.3) rgba(255,255,255,0.1);
        }
        
        /* Modal overlay animation */
        .modal-overlay {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-overlay:not(.active) {
            opacity: 0;
            visibility: hidden;
        }
        
        .modal-content {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: scale(0.95) translateY(20px);
        }
        
        .modal-overlay.active .modal-content {
            transform: scale(1) translateY(0);
        }
        
        /* Loading spinner */
        .loading {
            width: 0.8rem;
            height: 0.8rem;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #44F2E9;
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body class="font-ubuntu overflow-hidden gradient-bg text-white leading-relaxed flex flex-col h-screen">
    <!-- Header -->
    <header class="bg-primary-grad/95 backdrop-blur-sm border-b border-white/10 flex-shrink-0 h-15">
        <div class="h-full px-4 py-2 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 gradient-primary rounded-md flex items-center justify-center text-base text-white">
                    üêï
                </div>
                <div>
                    <h1 class="text-lg font-bold tracking-tight text-white">Oxy's Gallery - WSO2Con Asia</h1>
                    <p class="text-sm text-white/70 hidden sm:block">Adventures through four-legged eyes</p>
                </div>
            </div>
            <div class="flex items-center gap-3 font-semibold tracking-wider">
                {% if images_exist %}
                <div class="text-white px-3 py-1.5 rounded-full text-lg hidden sm:block">
                    {{ image_urls|length }} tail-wagging moments
                </div>
                {% endif %}
                <div class="bg-accent text-black px-3 py-1.5 rounded-full text-lg hidden sm:block hover:cursor-pointer hover:text-white hover:bg-highlight transition-all duration-300" onclick="location.reload()" aria-label="Check for Oxy's new adventures">
                    <span class="loading hidden" id="refreshSpinner"></span>
                    <span id="refreshText2">Check for New Adventures</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50" id="deleteModal">
        <div class="modal-content bg-white rounded-xl shadow-2xl max-w-md w-[90%] overflow-hidden">
            <div class="p-6 pb-0 text-center">
                <div class="w-16 h-16 bg-gradient-to-br from-red-100 to-red-200 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl">
                    üóëÔ∏è
                </div>
                <h3 class="text-lg font-semibold text-black mb-2">Remove Adventure?</h3>
                <p class="text-sm text-black/70">Are you sure you want to remove this precious memory from Oxy's collection?</p>
            </div>
            <div class="p-4 px-6">
                <img id="modalImagePreview" class="w-full max-h-32 object-cover rounded-lg mb-4" src="" alt="Image to delete">
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4 flex items-start gap-2">
                    <span class="text-yellow-600">‚ö†Ô∏è</span>
                    <div class="text-sm text-yellow-800">
                        <strong>This action cannot be undone.</strong><br>
                        Once removed, this adventure will be gone forever from Oxy's memory box.
                    </div>
                </div>
            </div>
            <div class="p-6 pt-0 flex gap-3 justify-end">
                <button class="px-5 py-2.5 bg-white text-black border border-black/20 rounded-lg font-medium text-sm hover:bg-highlight hover:text-white transition-colors min-w-20 flex items-center justify-center gap-2" onclick="closeDeleteModal()">
                    Keep Adventure
                </button>
                <button class="px-5 py-2.5 bg-red-600 text-white rounded-lg font-medium text-sm hover:bg-red-700 disabled:opacity-60 disabled:cursor-not-allowed transition-colors min-w-20 flex items-center justify-center gap-2" id="confirmDeleteBtn" onclick="confirmDelete()">
                    <span id="deleteModalSpinner" class="loading hidden"></span>
                    <span id="deleteModalText">Remove Forever</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="flex-1 p-4 flex flex-col min-h-0 bg-primary-grad">
        <!-- Gallery Grid -->
        <div class="grid grid-cols-1 md:grid-cols-[220px_1fr_30vw] lg:grid-cols-[250px_1fr_30vw] gap-4 flex-1 min-h-0">
            <!-- Thumbnail Section -->
            <div class="bg-secondary border border-white/10 rounded-lg shadow-lg transition-all duration-300 overflow-hidden flex flex-col min-h-0">
                <div class="flex items-center gap-2 font-semibold text-sm px-4 pt-4 pb-2 flex-shrink-0 text-white">
                    <span>üì∑</span>
                    <span>Latest adventures</span>
                </div>
                {% if images_exist %}
                <div class="flex-1 px-4 py-4 grid grid-cols-2 md:grid-cols-1 gap-2 overflow-y-auto min-h-0 custom-scrollbar">
                    {% for image_url in image_urls %}
                    <div class="thumbnail relative cursor-pointer rounded-md overflow-hidden transition-all duration-300 border-2 border-transparent hover:scale-105 hover:border-accent focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 {% if loop.first %}selected border-highlight shadow-highlight/20 shadow-md{% endif %}" 
                         onclick="selectImage('{{ image_url }}')" 
                         tabindex="0" 
                         role="button" 
                         aria-label="View Oxy's adventure {{ loop.index }}"
                         onkeydown="handleThumbnailKeydown(event, '{{ image_url }}')">
                        <img src="/images/{{ image_url }}" alt="Oxy's discovery {{ loop.index }}" loading="lazy" class="w-full h-24 object-cover block overflow-visible">
                        <div class="thumbnail-indicator absolute top-2 right-2 w-2 h-2 bg-accent rounded-full opacity-0 transition-all duration-300 {% if loop.first %}opacity-100{% endif %}"></div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="flex flex-col items-center justify-center h-full text-center text-white/70 p-4">
                    <div class="text-2xl mb-3 opacity-50">üîç</div>
                    <p class="font-medium text-white mb-2">Oxy's Out Exploring!</p>
                    <p class="text-sm">Our adventurous pup is busy discovering new moments to share with the family!</p>
                </div>
                {% endif %}
            </div>

            <!-- Main Image Display -->
            <div class="bg-white/10 border border-white/10 rounded-lg shadow-lg transition-all duration-300 overflow-hidden flex flex-col min-h-0">
                {% if images_exist %}
                <div class="relative flex-1 m-4 rounded-lg overflow-hidden bg-white/5 min-h-0 flex items-center justify-center group">
                    <img id="mainImage" src="/images/{{ image_urls[0] }}" alt="Oxy's selected adventure" class="w-full h-full object-contain block">
                    <div class="image-overlay-gradient absolute inset-0 opacity-0 group-hover:opacity-100 transition-all duration-300 flex items-end p-4">
                        <div class="text-white">
                            <div class="text-base font-semibold mb-1">Snapped by Oxy's curious lens</div>
                            <div class="text-sm opacity-90">Adventure Gallery ‚Ä¢ Captured with Love</div>
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="flex flex-col items-center justify-center h-full text-center text-white/70 p-4">
                    <div class="text-2xl mb-3">ü§ñ</div>
                    <h3 class="font-semibold text-white mb-2">Adventure Loading...</h3>
                    <p class="text-sm">Our four-legged photographer is out there sniffing out the perfect shots!</p>
                </div>
                {% endif %}
            </div>

            <!-- QR Code & Download Section -->
            <div class="bg-tertiary-grad border border-white/10 rounded-lg shadow-lg transition-all duration-300 overflow-hidden flex flex-col min-h-0">
                <div class="px-4 pt-4 pb-2 mt-10 text-center flex-shrink-0">
                    <h3 class="font-ubuntu font-bold text-3xl text-white">Scan to Download</h3>
                </div>
                
                {% if images_exist %}
                <div class="flex-1 flex flex-col justify-center items-center p-4 min-h-0">
                    <div class="bg-white rounded-xl p-4 shadow-lg">
                        <img id="qrImage" src="/qr/{{ image_urls[0]|basename }}" alt="QR Code to keep Oxy's adventures" class="w-full h-full block object-contain">
                    </div>
                </div>
                {% endif %}
                
                <div class="flex flex-col gap-3 px-20 flex-shrink-0 items-center justify-center py-4 font-semibold tracking-wider">
                    <div class="bg-accent text-black px-5 py-1.5 rounded-full text-lg hidden sm:block hover:cursor-pointer hover:text-white hover:bg-highlight transition-all duration-300 w-fit" onclick="deleteCurrentImage()" aria-label="Delete current image" id="deleteBtn">
                        <span class="loading hidden" id="deleteSpinner"></span>
                        <span id="refreshText2">üóëÔ∏è Bury the memory</span>
                    </div>
                    <button class="inline-flex items-center gap-2 px-3 py-2 bg-red-500 text-white border-none rounded-md font-medium text-sm cursor-pointer transition-all duration-300 hover:bg-red-600 hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none" onclick="deleteCurrentImage()" id="deleteBtn" aria-label="Delete current image">
                        <span class="loading hidden" id="deleteSpinner"></span>
                        <span id="deleteText">üóëÔ∏è Remove This Adventure</span>
                    </button>
                </div>

                <div class="px-4 py-3 border-t border-white/10 text-xs text-white/70 text-center flex-shrink-0">
                    <p>Lovingly captured by</p>
                    <div class="flex items-center justify-center gap-2 mt-2">
                        <div class="w-5 h-5 gradient-primary rounded-full flex items-center justify-center text-xs text-white">üêï</div>
                        <span>Oxy, our family explorer</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Mobile Responsive Adjustments -->
    <style>
        @media (max-width: 767px) {
            .gallery-grid {
                grid-template-rows: 120px 1fr 40vh;
                grid-template-columns: 1fr;
            }
            
            .thumbnail-grid {
                display: flex !important;
                overflow-x: auto;
                padding-bottom: 0.5rem;
            }
            
            .thumbnail {
                flex-shrink: 0;
                width: 80px;
                aspect-ratio: 1;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                height: 50px;
            }
        }
    </style>

<script>
    let currentSelectedImage = null; // Track the currently selected image

    function updateBadgeCount() {
        const badge = document.querySelector('.badge');
        if (badge) {
            const remainingCount = document.querySelectorAll('.thumbnail').length;
            if (remainingCount > 0) {
                badge.textContent = `${remainingCount} Tail-Wagging Moment${remainingCount !== 1 ? 's' : ''}`;
                // Add a subtle animation to highlight the change
                badge.style.transform = 'scale(1.1)';
                badge.style.transition = 'transform 0.2s ease-out';
                setTimeout(() => {
                    badge.style.transform = 'scale(1)';
                }, 200);
            } else {
                // Hide badge when no images left
                badge.style.opacity = '0';
                badge.style.transform = 'scale(0.8)';
            }
        }
    }

    function basename(path) {
        return path.split('.').slice(0, -1).join('.');
    }

    function selectImage(imageUrl) {
        const mainImg = document.getElementById('mainImage');
        const qrImg = document.getElementById('qrImage');
      
        if (mainImg) {
            mainImg.src = '/images/' + imageUrl;
        }
        
        if (qrImg) {
            qrImg.src = '/qr/' + imageUrl;
        }

        // Store the currently selected image
        currentSelectedImage = imageUrl;

        // Update selected thumbnail style
        document.querySelectorAll('.thumbnail').forEach(el => {
            el.classList.remove('selected', 'border-highlight', 'shadow-highlight/20', 'shadow-md');
            el.classList.add('border-transparent');
            el.setAttribute('aria-pressed', 'false');
            const indicator = el.querySelector('.thumbnail-indicator');
            if (indicator) {
                indicator.classList.remove('opacity-100');
                indicator.classList.add('opacity-0');
            }
        });
        
        // Find and select the clicked thumbnail
        const thumbnails = document.querySelectorAll('.thumbnail img');
        thumbnails.forEach(el => {
            if (el.src.includes('/images/' + imageUrl)) {
                const thumbnail = el.parentElement;
                thumbnail.classList.add('selected', 'border-highlight', 'shadow-highlight/20', 'shadow-md');
                thumbnail.classList.remove('border-transparent');
                thumbnail.setAttribute('aria-pressed', 'true');
                const indicator = thumbnail.querySelector('.thumbnail-indicator');
                if (indicator) {
                    indicator.classList.add('opacity-100');
                    indicator.classList.remove('opacity-0');
                }
            }
        });

        // Update delete button state
        updateDeleteButtonState();
    }

    function updateDeleteButtonState() {
        const deleteBtn = document.getElementById('deleteBtn');
        if (deleteBtn) {
            deleteBtn.disabled = !currentSelectedImage;
            if (!currentSelectedImage) {
                deleteBtn.style.opacity = '0.5';
                deleteBtn.title = 'Please select an image first';
            } else {
                deleteBtn.style.opacity = '1';
                deleteBtn.title = 'Delete selected image';
            }
        }
    }

    function handleThumbnailKeydown(event, imageUrl) {
        if (event.key === 'Enter' || event.key === ' ') {
            event.preventDefault();
            selectImage(imageUrl);
        }
    }

    // Enhanced refresh functionality
    function refreshGallery() {
        const refreshBtn = document.getElementById('refreshBtn');
        const refreshIcon = document.getElementById('refreshIcon');
        const refreshText = document.getElementById('refreshText');
        
        if (refreshIcon && refreshText) {
            refreshIcon.innerHTML = '<span class="loading"></span>';
            refreshText.textContent = "Oxy's fetching new memories...";
            refreshBtn.disabled = true;
        }
        
        // Simulate loading delay for better UX
        setTimeout(() => {
            location.reload();
        }, 500);
    }

    // Modal functions
    function openDeleteModal() {
        const modal = document.getElementById('deleteModal');
        const modalImagePreview = document.getElementById('modalImagePreview');
        
        if (currentSelectedImage && modalImagePreview) {
            modalImagePreview.src = '/images/' + currentSelectedImage;
        }
        
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
        
        // Focus on the modal for accessibility
        const confirmBtn = document.getElementById('confirmDeleteBtn');
        if (confirmBtn) {
            setTimeout(() => confirmBtn.focus(), 100);
        }
    }

    function closeDeleteModal() {
        const modal = document.getElementById('deleteModal');
        modal.classList.remove('active');
        document.body.style.overflow = '';
        
        // Reset modal state
        const confirmBtn = document.getElementById('confirmDeleteBtn');
        const spinner = document.getElementById('deleteModalSpinner');
        const text = document.getElementById('deleteModalText');
        
        if (confirmBtn) confirmBtn.disabled = false;
        if (spinner) spinner.classList.add('hidden');
        if (text) text.textContent = 'Remove Forever';
    }

    // Keyboard navigation
    document.addEventListener('keydown', function(event) {
        // Close modal on Escape
        if (event.key === 'Escape') {
            const modal = document.getElementById('deleteModal');
            if (modal.classList.contains('active')) {
                closeDeleteModal();
                return;
            }
        }
        
        // Don't handle other keys if modal is open
        const modal = document.getElementById('deleteModal');
        if (modal.classList.contains('active')) {
            return;
        }
        
        if (event.key === 'ArrowLeft' || event.key === 'ArrowRight') {
            const thumbnails = Array.from(document.querySelectorAll('.thumbnail'));
            const selected = document.querySelector('.thumbnail.selected');
            
            if (!selected || thumbnails.length === 0) return;
            
            const currentIndex = thumbnails.indexOf(selected);
            
            let nextIndex;
            if (event.key === 'ArrowLeft') {
                nextIndex = currentIndex > 0 ? currentIndex - 1 : thumbnails.length - 1;
            } else {
                nextIndex = currentIndex < thumbnails.length - 1 ? currentIndex + 1 : 0;
            }
            
            const nextThumbnail = thumbnails[nextIndex];
            if (nextThumbnail) {
                const img = nextThumbnail.querySelector('img');
                if (img) {
                    const imageUrl = img.src.split('/images/')[1];
                    selectImage(imageUrl);
                    nextThumbnail.focus();
                }
            }
        } else if (event.key === 'Delete' && currentSelectedImage) {
            // Allow deletion with Delete key - open modal instead of direct delete
            deleteCurrentImage();
        }
    });

    // Close modal when clicking on overlay
    document.addEventListener('click', function(event) {
        const modal = document.getElementById('deleteModal');
        const modalContent = modal.querySelector('.modal-content');
        
        if (event.target === modal && !modalContent.contains(event.target)) {
            closeDeleteModal();
        }
    });

    // Initialize accessibility attributes and set first image as selected
    document.addEventListener('DOMContentLoaded', function() {
        const thumbnails = document.querySelectorAll('.thumbnail');
        
        if (thumbnails.length > 0) {
            // If no thumbnail is selected, select the first one
            let selected = document.querySelector('.thumbnail.selected');
            if (!selected) {
                const firstThumbnail = thumbnails[0];
                const firstImg = firstThumbnail.querySelector('img');
                if (firstImg) {
                    const imageUrl = firstImg.src.split('/images/')[1];
                    selectImage(imageUrl);
                }
            } else {
                // Get the currently selected image
                const selectedImg = selected.querySelector('img');
                if (selectedImg) {
                    currentSelectedImage = selectedImg.src.split('/images/')[1];
                }
            }
            
            selected.setAttribute('aria-pressed', 'true');
        }
        
        document.querySelectorAll('.thumbnail:not(.selected)').forEach(el => {
            el.setAttribute('aria-pressed', 'false');
        });

        // Update delete button state on load
        updateDeleteButtonState();
    });

    function deleteCurrentImage() {
        // Use the tracked selected image
        if (!currentSelectedImage) {
            // Show a nice notification instead of alert
            const notification = document.createElement('div');
            notification.className = 'fixed top-5 right-5 bg-red-50 text-red-900 p-4 rounded-lg border border-red-200 z-50 shadow-lg animate-slide-in-right max-w-sm';
            notification.innerHTML = `
                <div class="flex items-center gap-2">
                    <span class="text-lg">‚ö†Ô∏è</span>
                    <span>Please select an image from the thumbnail gallery first</span>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
            return;
        }
        
        console.log('Opening delete modal for image:', currentSelectedImage);
        openDeleteModal();
    }

    function confirmDelete() {
        const confirmBtn = document.getElementById('confirmDeleteBtn');
        const spinner = document.getElementById('deleteModalSpinner');
        const text = document.getElementById('deleteModalText');
        
        // Show loading state
        if (spinner) spinner.classList.remove('hidden');
        if (text) text.textContent = 'Removing...';
        confirmBtn.disabled = true;
        
        // Make delete request
        fetch(`/images/${currentSelectedImage}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => {
            console.log('Response status:', response.status);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('Delete response:', data);
            if (data.status === 'success') {
                // Close modal first
                closeDeleteModal();
                
                // Show success notification
                showNotification('Adventure removed successfully! üêï', 'success');
                
                // Remove the deleted thumbnail from DOM
                const thumbnails = document.querySelectorAll('.thumbnail');
                thumbnails.forEach(thumbnail => {
                    const img = thumbnail.querySelector('img');
                    if (img && img.src.includes(currentSelectedImage)) {
                        thumbnail.remove();
                    }
                });
                
                // Update the badge count
                updateBadgeCount();
                
                // Select next available image or reload if no images left
                const remainingThumbnails = document.querySelectorAll('.thumbnail');
                if (remainingThumbnails.length > 0) {
                    const firstImg = remainingThumbnails[0].querySelector('img');
                    if (firstImg) {
                        const nextImageUrl = firstImg.src.split('/images/')[1];
                        selectImage(nextImageUrl);
                    }
                } else {
                    // No images left, reload page
                    setTimeout(() => {
                        location.reload();
                    }, 1500);
                }
            } else {
                throw new Error(data.message || 'Delete failed');
            }
        })
        .catch(error => {
            console.error('Error deleting image:', error);
            closeDeleteModal();
            showNotification(`Failed to delete image: ${error.message}`, 'error');
        });
    }

    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        let bgColor = 'bg-blue-50 text-blue-900 border-blue-200';
        
        if (type === 'success') {
            bgColor = 'bg-green-50 text-green-900 border-green-200';
        } else if (type === 'error') {
            bgColor = 'bg-red-50 text-red-900 border-red-200';
        }
        
        notification.className = `fixed top-5 right-5 ${bgColor} p-4 rounded-lg border z-50 shadow-lg animate-slide-in-right max-w-sm font-medium`;
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.classList.remove('animate-slide-in-right');
            notification.classList.add('animate-slide-out-right');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 3000);
    }

    console.log("Oxy's Memory Box - Adventures through four-legged eyes loaded! üêïüì∑");
</script>

</body>
</html>